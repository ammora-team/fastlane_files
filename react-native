def react_native_path
  gpg_cmd = `which react-native`

  unless gpg_cmd.empty?
    return 'react-native'
  end

  Dir.chdir ".." do
    if File.file?('./node_modules/.bin/react-native')
      return '../node_modules/.bin/react-native'
    end
  end

end

lane :requirements do
  is_install = react_native_path

  if (is_install.empty?)
    UI.user_error!("'react-native' not installed")
  else
end

platform :ios do
  lane :build_artifact do |options|
    export = 'development'
    configuration = 'Debug'

    scheme = options[:scheme] ? options[:scheme] : ENV['APP_SCHEME']
    workspace = options[:xcworkspace] ? options[:xcworkspace] : ENV['APP_XCWORKSPACE']

    if (options[:env] === 'staging' || options[:env] === 'prod')
      export = 'app-store'
      configuration = 'Release'
    end

    clean = false
    if (options[:clean])
      clean = true
    end

    # build
    build_app(
      scheme: scheme,
      export_method: export,
      configuration: configuration,
      workspace: workspace,
      clean: clean,
      output_directory: './deploy'
    )

    options
  end

end
